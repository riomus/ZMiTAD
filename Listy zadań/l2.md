Lista 2 - Testowanie hipotez statystycznych
==========

**R**
--------

*  [r-project](https://www.r-project.org/)
*  [r dla Windowsa](https://cran.r-project.org/bin/windows/base/)
*  [r dla linuxa](https://cran.r-project.org/bin/linux/), poszczególne dystrybucje mają R w swoich repozytoriach i można zainstalować go bezpośrednio stamtąd
*  [IDE dla R](https://www.rstudio.com/products/rstudio/download/)
*  [CRAN - repozytorium pakietów R](https://cran.r-project.org/web/packages/)
*  [Wprowadzenie do R](https://cran.r-project.org/doc/contrib/Paradis-rdebuts_en.pdf)



*Na podstawie materiałów z poprzednich lat*

Hipoteza zerowa i alternatywna
-------------------------------

Hipotezą statystyczną jest dowolne przypuszczenie co do rozkładu populacji generalnej (jego
postaci funkcyjnej lub wartości parametrów). Prawdziwość tego przypuszczenia jest oceniana
na podstawie wyników próby losowej.

Testem statystycznym nazywamy regułę postępowania, która każdej możliwej próbie przyporządkowuje
decyzję przyjęcia lub odrzucenia hipotezy. Oznacza to, że test statystyczny jest
regułą rozstrzygającą, jakie wyniki próby pozwalają uznać sprawdzaną hipotezę za prawdziwą,
a jakie – za fałszywą.

Testy statystyczne dzielimy zasadniczo na:
* parametryczne, czyli dotyczące wartości parametrów statystycznych populacji, takich
jak np. średnia,
* nieparametryczne, czyli dotyczące postaci rozkładu zmiennej lub losowości próby.

Hipotezę, która podlega weryfikacji nazywamy hipotezą zerową, a jej przeciwieństwo - hipotezą
alternatywną.

Każdy test statystyczny rozpoczynamy od sformułowania hipotezy zerowej H0, czyli hipotezy
podlegającej sprawdzeniu, oraz hipotezy konkurencyjnej H1, którą jesteśmy w stanie przyjąć,
gdy odrzucimy hipotezę zerową. Ponadto musimy określić poziom istotności α , czyli maksymalne
ryzyko błędu, jakie badacz jest skłonny zaakceptować.
Następnie wybieramy odpowiednią statystykę testową (wybór statystyki uzależniony od informacja
jaką posiadamy o próbie oraz od postaci hipotezy zerowej i alternatywnej) oraz obliczamy
wartość tej funkcji dla badanej próby. Jeśli prawdopodobieństwo osiągnięcia otrzymanej
bądź jeszcze bardziej ekstremalnej wartości statystyki jest niskie to wątpimy, że nasze
dane są zgodne z hipotezą zerową i jesteśmy skłonni przyjąć hipotezę alternatywną:
* Jeżeli p <=α ⇒ odrzucamy H0 przyjmując H1,
* Jeżeli p > α ⇒ nie ma podstaw, aby odrzucić H0.
* Inaczej: jeżeli wartość statystyki wpada do obszaru krytycznego to odrzucamy H0
przyjmując H1, w przeciwnym przypadku nie ma podstaw, aby odrzucić H0. 

**Uwaga:** Testy statystyczne w zależności od wyniku pozwalają nam hipotezę zerową odrzucić i wtedy przyjąć hipotezę konkurencyjną lub nie dają podstaw do odrzucenia H0, co **nie jest równoznaczne z jej przyjęciem**. Używając testów, którymi dysponuje MATLAB, należy sprawdzić, jaka hipoteza przyjmowana jest w tym teście. 


Testowanie hipotez na temat średniej
--------------------------------------

**Przykład 1.** Każda linia komunikacji miejskiej ma określony czas przejazdu (od pętli do pętli).
Przeprowadźmy test hipotezy dla wybranej linii. Podany czas na rozkładzie wynosi 28 minut.

**H0:** µ=28

**H1:** µ≠28

Wybieramy losową próbę 100 przejazdów tej linii i obliczamy średni czas dla tej próby
x = 31,5 minuty. i odchylenie standardowe próby s = 5 minut. Przy założeniu normalności
rozkładu, średnia arytmetyczna próby pobranej z populacji o rozkładzie N(µ,σ) ma rozkład 
![eq](https://latex.codecogs.com/gif.latex?N%28%5Cmu%2C%5Cfrac%7B%5Csigma%7D%7B%5Csqrt%7BN%7D%7D%29)
Jeśli prawdziwa jest hipoteza zerowa, to statystyka o postaci 
![eq](https://latex.codecogs.com/gif.latex?Z%3D%5Cfrac%7B%5Cbar%7BX%7D-%5Cmu%7D%7B%5Csigma%7D%5Csqrt%7Bn%7D) ma rozkład N(0,1)

zatem:

![eq](https://latex.codecogs.com/gif.latex?z%3D%5Cfrac%7B%5Cbar%7Bx%7D-%5Cmu%7D%7B%5Csigma%7D%5Csqrt%7Bn%7D%3D%5Cfrac%7B31.5-28%7D%7B5%7D*%5Csqrt%7B100%7D%3D7)

![eq](https://latex.codecogs.com/gif.latex?z_%7B%5Cfrac%7B%5Calpha%7D%7B2%7D%7D%3D1.96)

![eq](https://latex.codecogs.com/gif.latex?7%3Ez_%7B%5Cfrac%7B%5Calpha%7D%7B2%7D%7D)

Gdzie ![eq](https://latex.codecogs.com/gif.latex?z_%7B%5Cfrac%7B%5Calpha%7D%7B2%7D%7D) to wartość odczytana z tablicy statystycznej dostępnej na przykład [tutaj](http://prac.im.pwr.wroc.pl/~bogdan/IPS/Tables/).

Dlatego odrzucamy H0 na poziomie α=0,05.

Do badania hipotez dotyczących średniej służą funkcje: 

   * Matlab:
      * ttest
      * ttest2
      * tcdf
      * tinv


   * R:
      * t.test
      * pt
      * dt
      * qt

Więcej informacji na temat założeń ttestu będzie można znaleźć w kolejnych listach.

Matlab:
```matlab
[h,p] = ttest(x,m)
tcdf(t,n-1) 
```
R:
```
t.test(x,mu=0)
dt(t,n-1)
```

Testowanie hipotez na temat wariancji 
--------------------------------------

Jednym z założeń testów parametrycznych (np. t-testu dla dwóch prób) jest homogeniczność
wariancji. Homogeniczność możemy tutaj rozumieć jako równość, jednolitość. Dokładniej,
porównywane ze sobą grupy, za pomocą testów parametrycznych powinny mieć podobne
wariancje. Oznacza to, różnorodność uzyskanych wyników w poszczególnych grupach powinna
być podobna. Do badania wariancji w grupie bądź w kilku grupach służą następujące
testy:

1. Do testowania hipotez na temat wariancji używamy statystyki chi-kwadrat o n − 1 stopniach swobody: 

   Matlab:
   ```matlab
   vartest(x,v)
   ```
   R:
   ```R
   library(EnvStats) # install.packages(EnvStats)
   varTest(x,sigma.squared=v)
   ```


   ![eq](https://latex.codecogs.com/gif.latex?%5Cchi%5E2%3D%5Cfrac%7B%28n-1%29s%5E2%7D%7B%5Csigma_0%5E2%7D)

   Gdzie s jest wariancją n-elementowej próby wylosowanej z populacji, a ![eq](https://latex.codecogs.com/gif.latex?%5Csigma_0%5E2)
 jest wartością wariancji podaną w H0.

   Test ten pozwala ocenić czy wariancja w próby jest równą założonej wariancji v. 

2.  Do testowania równości wariancji w dwóch populacjach stosuje się test F

   Matlab:
   ```matlab
   vartest2(x,y)
   ```
   R:
   ```R
   var.test(x,y)
   ```


   ![eq](https://latex.codecogs.com/gif.latex?F_%7B%28n_1-1%2Cn_2-1%29%7D%3D%5Cfrac%7Bs_1%5E2%7D%7Bs%5E2_2%7D)

   gdzie ![eq](https://latex.codecogs.com/gif.latex?s_1%5E2%5C%20i%20%5C%20s%5E2_2) są wariancjami prób o odpowiendio n1 i n2 elementach wylosowanych z populacji

   Przydatna może być również statystyka porównująca wariancję w większej ilości grup np. test Barletta czy test Levene’a


Zadania
----------

1. Każda linia komunikacji miejskiej ma określony czas przejazdu (od pętli do pętli).
   Wybieramy losową próbę 100 przejazdów tej linii i obliczamy średni czas dla tej próby x = 31,5 minuty. i odchylenie standardowe próby s = 5 minut
   Podany czas na rozkładzie wynosi 25 minut.
   
   1. Jaka jest hipoteza zerowa?
   2. Przeprowadź test hipotezy dla podanej linii. 
   

   **Środowisko:** Matlab

2. Chcemy sprawdzić, czy czas oczekiwania na dostarczenie przesyłki przez
   pewna firmę kurierską to przeciętnie 4 dni (m = 4). W tym celu z populacji klientów tej firmy
   wylosowano próbę liczącą 20 osób i zapisano informacje o ilości dni, jakie minęły od dnia
   nadania przesyłki do jej dostarczenia, były to następujące wielkości: (1, 1, 1, 2, 2, 2, 2, 3, 3,
   3, 4, 4, 4, 4, 4, 5, 5, 6, 6, 6). Ilość dni oczekiwania na przesyłkę w badanej populacji
   spełnia założenie normalności 

   1. Przeprowadź test hipotezy na temat średniego czasu dostarczenia

   **Środowisko:** Matlab

3. Agencja nieruchomości podała, że ceny gruntu w centrum miasta wzrosły o
   39% w ciągu 3 lat. Inwestor chcąc przetestować te dane, znajduje próbę 18 nieruchomości w
   centrum, dla których zna cenę obecną i sprzed 3 lat. Dla każdej nieruchomości oblicza procentowy
   wzrost wartości a następnie znajduje średnią i odchylenie standardowe z próby.
   Statystyki próby wynoszą m=40% i s = 14%. 
   
   1. Przeprowadź test na poziomie istotności α =0.02 że średnia cena gruntu wzrosła o nie mniej niż 39%

   **Podpowiedź** Wykorzystaj funkcję tcdf. Zastanów się ile stopni swobody powinieneś podać (n-1)

   **Środowisko:** Matlab

4. Chcemy sprawdzić, czy odchylenie standardowe w rozkładzie czasu montowania
   elementu w pralce rzeczywiście wynosi v=2 minuty. Wygeneruj 25-elementową próbę
   rozkładu normalnego o dowolnej średniej i zadanym odchyleniu. 

   1. Sprawdź stosując odpowiedni test (z właściwie dobranymi parametrami) czy wariancja wygenerowanej próby jest mniejsza niż 2,3min? 
   2. Przeprowadź powyższy test dla trzech różnych wartości parametru α. Czym jest ten parametr?


   **Środowisko:** Matlab

5. Przypuszcza się, że młodsze osoby łatwiej decydują się na zakup nowych nieznanych
   produktów. Badanie przeprowadzone wśród przypadkowych 20 nabywców nowego
   produktu i 22 nabywców znanego już wyrobu pewnej firmy dostarczyło następujących informacji
   o wieku klientów: 

   * Nabywcy nowego produktu: średnia 27,7; odchylenie standardowe 5,5.
   * Nabywcy znanego produktu: średnia 32,1; odchylenie standardowe 6,3.

   1. Wygeneruj dwa zestawy danych o zadanych parametrach. Czy różnica pomiędzy odchyleniami standardowymi jest statystycznie znacząca? 
   2. Sformułuj wnioski wynikające z przeprowadzonej analizy?  

   **Środowisko:** Matlab

6. Studenci mają podany termin przesyłania rozwiązanych list zadań.
   Wybieramy losową próbę studentów z kursu ZMiTAD (15 osób), średni czas od otrzymania listy do jej rozwiązania to x = 7 dni, odchylenie standardowe próby s = 1 dzień. Załóżmy normalność podanego rozkładu.
   Czas o który walczą studenci to 8 dni. 
   
   1. Czy studenci potrzebują tych 8 dni? Jaka jest hipoteza zerowa?
   2. Przeprowadź test hipotez.
   
   **Podpowiedź** wylosuj próbę o zadanych parametrach, sprawdź czy średnia jest więskza od podanej wartości.

   **Środowisko:** R

7. Oceny jednej z grup studentów z kursu ZMiTAD z zeszłego roku to 4.0;3.0;2.0;2.0;3.0;2.0;2.0;2.0;4.0 . Załóżmy że dane te spełniają założenie normalności. Średnia z ocen wszystkich grup to 3.5.

   1. Przeprowadź test hipotezy na temat średniej ocen
   

   **Środowisko:** R

8. Wykonaj zadanie 5 w środowisku R

   **Środowisko:** R