Lista 12 - ANOVA
==========

Proszę się nie bać zadawania pytań ani pisania maili. 

*Na podstawie materiałów z poprzednich lat*

ANOVA (ang. ANalysis Of VAriance) to zbiór metod i modeli statystycznych pozwalających
na porównywanie dwu lub więcej populacji pod względem ich średniej. ANOVA jest szczególnie
przydatna przy większej liczby grup niż 2, gdyż pozwala uniknąć – w przypadku korzystania z
innych testów – wykonywania testów dla wszystkich możliwych par, tj. z pomocą metod z
rodziny ANOVA porównujemy więcej grup jednocześnie, nie zaś wszystkie pary po kolei. W
Matlabie metody z tej grupy są zaimplementowane jako część toolboxa Statistics (Statistics
Toolbox > Regression and Classification > ANOVA).

Jednoczynnikowa analiza wariancji (one-way analysis of variance, one-way ANOVA)
Jednoczynnikowa analiza wariancji jest testem statystycznym dla danych numerycznych
służącym do porównywania średnich w wielu populacjach. Zazwyczaj stosuje się ją do
porównywania przynajmniej trzech grup jednocześnie, zaś przy dwu grupach pozostaje się przy
t-teście.


Przyjmuje się następujące założenia:
* Populacje źródłowe muszą mieć rozkład normalny
* Próbki muszą być niezależne
* Wariancje poszczególnych populacji muszą być równe


przy czym dopuszcza się niewielkie odstępstwa od dwóch pierwszych założeń.

Testowana jest następująca hipoteza zerowa
* H0: próbki zawarte we wszystkich (dwu lub więcej) grupach pochodzą z populacji o jednakowych wartościach średnich.
* H1: dla przynajmniej jednej próbki średnia z niej jest znaczą

Wykorzystanie funkcji anova1 na macierzy X w Matlabie powoduje wyświetlenie dwu grup
wyników. Po pierwsze, standardowej dla ANOVA tabeli oraz boxplotów wykonanych dla
poszczególnych kolumn macierzy X. Standardowa tabela wyników rozróżnia dwa typy wariancji:
wariancję wynikającą z różnic pomiędzy średnimi z kolumn (wariancję międzygrupową) oraz
wariancję wynikającą z różnic pomiędzy danymi w poszczególnych kolumnach a ich
odpowiadającymi średnimi (wariancję wewnątrzgrupową).
Standardowa tabela wyników dla ANOVA zawiera sześć kolumn:
* źródło wariancji (Source): międzygrupowa, wewnątrzgrupowa, łączna
* suma kwadratów (SS) odchyleń poszczególnych średnich od średniej globalnej
* liczba stopni swobody (df) dla każdego źródła
* MS (mean-square) wyliczone jako SS/df
* Statystykę F wyznaczoną jako MS(Columns)/MS(Error)
* P-value wyznaczone z wykorzystaniem dystrybuanty dla F

Uwaga: Jeżeli dane w poszczególnych grupach nie są równoliczne, konieczne jest ich
wcześniejsze przygotowanie.

Przykład
---------
Załóżmy, że mamy dane zawarte w jednym wektorze o 20 elementach:

```matlab
X = [82 86 79 83 84 85 86 87 74 82 ... 78 75 76 77 79 79 77 78 82 79];
```

Niech pierwsze 8 wyników pochodzi z testów wytryzmałościowych wykonanych na stali (steel),
kolejne 6 z testów na pierwszym stopie (alloy1) i ostatnie 6 z testów na drugim stopie (alloy2).
Należy wtedy przygotować dodatkową zmienną która opisze grupy danych. Może ona mieć
postać zmiennej typu cell o jednakowej długości zawierającej identyfikatory grup dla kolejnych
danych z pierwotnego wektora, np:

```matlab
group = {'st','st','st','st','st','st','st','st',...,'al1','al1','al1','al1','al1','al1',...,'al2','al2','al2','al2','al2','al2'};
 ```

Możliwe są też inne reprezentacje grup (Matlab: Grouping Variables). Na przykład za
pomocą zwykłego wektora liczb. Dla powyższego przykładu mógłby on mieć postać:

```matlab
group = [1,1,1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3];
```

Następnie wywołujemy metodę anova1 korzystając z wektora z danymi i z wektora
opisującego przynależność grupową danych: p = anova1(X,group).


Matlab
-------

[help](https://www.mathworks.com/help/stats/analysis-of-variance-and-covariance.html)



Zadania
----------

**Środowisko:** Matlab

1. 	Wczytaj dane z pliku [anova_data](https://github.com/riomus/ZMiTAD/tree/2015/2016-lato/Listy%20zada%C5%84/Dane) dołączone do listy zadań. Dane w zmiennej koala
przedstawiają dobowy czas snu trzech grup zwierząt. Zweryfikować czy dane w
poszczególnych grupach pochodzą z niezależnych populacji o rozkładzie normalnym (wykonać test normalności) i o
równych wariancjach (potraktować to jako wprawkę do końcowych list: wybrać test,
sformułować hipotezy, zinterpretować wynik). Jeżeli tak, wykorzystać jednoczynnikową analizę
wariancji w celu zweryfikowania odpowiedniej hipotezy dotyczącej równości średnich w
powyższych trzech populacjach. Zinterpretować wynik.

2. 	Dane w zmiennych wombats i wombats_groups przedstawiają dane dotyczące aktywności
dobowej wombatów. Przyjmując, że dane w poszczególnych grupach pochodzą z niezależnych
populacji o rozkładzie normalnym i o równych wariancjach wykorzystać jednoczynnikową
analizę wariancji w celu zweryfikowania odpowiedniej hipotezy dotyczącej równości średnich we
wszystkich populacjach. Zinterpretować wynik.
