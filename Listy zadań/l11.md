Lista 11 - Testy nieparametryczne dla prób zależnych
==========

Proszę się nie bać zadawania pytań ani pisania maili. 

*Na podstawie materiałów z poprzednich lat*

Do testów nieparametrycznych dla prób zależnych należą:
* test znaków
* test kolejności par Wilcoxona
* [test McNemary](https://en.wikipedia.org/wiki/McNemar's_test)

Testy te stanowią nieparametryczną alternatywę testu t-Studenta dla zmiennych powiązanych,
a stosujemy je, gdy dysponujemy dwoma pomiarami (przed jakimś wydarzeniem i po) i chcemy
dowieść, że pomiary te się różnią. Inaczej mówiąc, testy te są przeznaczone do sprawdzania
istotności różnic między dwoma zależnymi pomiarami.
Te dwa zależne pomiary to albo dwie obserwacje u tej samej osoby (np. przed zabiegiem i po),
albo obserwacje u par osób o tych samych właściwościach (tzw. równoważne dwójki).
Hipoteza zerowa mówi, że wyniki obu pomiarów są jednakowe. Testy te stosujemy również
wtedy, gdy nie są spełnione założenia testu t dla zmiennych powiązanych. Za ich pomocą
możemy stwierdzić, czy próby różnią się między sobą pod względem pewnych własności. Te
łatwe w użyciu testy wymagają jedynie założenia, że wartości badanych zmiennych możemy
uporządkować (są mierzalne na skali porządkowej)

Dla sprawdzenia, czy dwa pomiary różnią się między sobą stosujemy test znaków lub test
Wilcoxona. Oba te testy dotyczą zmiennych zależnych, najczęściej są to pomiary pochodzące
od tych samych osób.

**Hipoteza zerowa** mówi, że wyniki obu próbek są jednakowe.

**Test znaków** oparty jest na znakach różnic pomiędzy parami wyników. Liczba plusów i
minusów jest zliczana i porównywana z wartością teoretyczną umieszczoną w odpowiednich
tabelach. Tracimy informację niesioną przez liczbowe wartości różnic.

**Test kolejności par Wilcoxona** uwzględnia zarówno znak różnic, ich wielkość, jak i kolejność.
Po uporządkowaniu różnic w sposób rosnący są im przypisywane rangi, a następnie sumowane
osobno rangi różnic dodatnich i ujemnych. Ich suma po porównaniu z tabelą wartości
teoretycznych decyduje o przyjęciu lub nie hipotezy zerowej.

## [Test znaków](http://www.mathworks.com/help/stats/signtest.html)

Test ten oparty jest na znakach różnic między kolejnymi parami wyników (badaniu czy są one
ujemne, czy dodatnie). W ten sposób otrzymujemy ustaloną liczbę wyników z jednego zbioru,
które są mniejsze od swych odpowiedników w drugim zbiorze oraz liczbę wyników z tego
samego zbioru, które są większe od swych odpowiedników w drugim zbiorze. Tym samym
dowiadujemy się, ile danych zostało niejako "przesuniętych" w jednym z kierunków w naszym
eksperymencie.
Naturalnie gdy zaobserwujemy, iż wszystkie wyniki zostały przesunięte, to łatwo stwierdzić, że
test daje wynik istotny. Jednakże w przeciwnym przypadku sytuacja nie jest już tak oczywista.
Dlatego też skupiamy się na wyznaczeniu prawdopodobieństwa związanego ze wszystkimi
proporcjami wystąpienia znaków +/-, które mogłyby wystąpić. W konsekwencji znając
prawdopodobieństwo każdej kierunkowej zmiany możemy ocenić czy nasze wyniki są istotne
czy też nie.
Innymi słowy test znaków polega na ustaleniu liczby plusów oraz minusów, następnie
porównanie ich z teoretyczną wartością - dostępną w odpowiednich tablicach. Test ten
stosujemy więc przede wszystkim dla cech jakościowych. Wystarczy bowiem sprawdzić, że
dana jednostka charakteryzuje się obecnością ("+") lub nieobecnością ("-") danego zjawiska.
Dla danych mierzalnych nie uwzględniamy wartości różnic, lecz jedynie ich znaki. Różnice o
wartości zero są pomijane.

### Założenia
* Pary próbek skorelowanych (xi,yi) są losowe i niezależne, tj. różnice zi=yi-xi są niezależne oraz pochodzą z tego samego rozkładu, o medianie θ.
* Przestrzeń wartości powinna mieć przynajmniej zdefiniowany porządek (ordinal scale), a najlepiej gdyby była ciągła.

[wiki](https://en.wikipedia.org/wiki/Sign_test)

## [Wilcoxon rank-sum](http://www.mathworks.com/help/stats/ranksum.html)

Test kolejności par Wilcoxona uwzględnia znak różnic, ich wielkość, jak również ich kolejność
(stąd nazwa). Po uporządkowaniu różnic w szereg rosnący przypisujemy im rangi. Następnie
osobno sumujemy rangi różnic dodatnich i ujemnych. Mniejsza z otrzymanych sum to wartość
testu Wilcoxona, która po porównaniu z odpowiednią wartością teoretyczną w tablicach
decyduje o odrzuceniu hipotezy zerowej lub nie.
Ten nieparametryczny test można wykorzystać zarówno do sparowanych, jak i nie sparowanych
zbiorów danych, i pozwala on na weryfikację czy dwie próby pochodzą z identycznego ciągłego
rozkładu prawdopodobieństwa o takich samych medianach, względem alternatywy, iż rozkłady
te nie mają takich samych median. 

### Założenia
Pary próbek skorelowanych (xi,yi) są losowe i niezależne, tj. różnice zi=yi-xi są niezależne oraz
pochodzą z tego samego rozkładu - symetrycznego względem wspólnej mediany θ.
Przestrzeń wartości powinna mieć przynajmniej zdefiniowany porządek (ordinal scale), a
najlepiej gdyby była ciągła

[wiki](https://en.wikipedia.org/wiki/Wilcoxon_signed-rank_test)

Zadania
----------

**Środowisko:** Dowolne

1. Załóżmy, że przeprowadziliśmy badanie ciężaru ciała w grupie 20 kobiet przed 7-tygodniową
dietą odchudzającą i po niej. Otrzymane dane przedstawiono:
	```
	w1=[88,69,86,59,57,82,94,93,64,91,86,59,91,60,57,92,70,88,70,85]
	w2=[73,68,75,54,53,84,84,86,66,84,78,58,91,57,59,88,71,84,64,85]
	```

	Chcemy sprawdzić, czy otrzymane wyniki przeczą hipotezie, że dieta nie powoduje
	zmniejszenia ciężaru ciała.
	Na początku przeanalizuj dostępne dane za pomocą znanych Ci metod graficznych.
	Ponieważ nasze dane to dwie obserwacje u tej samej osoby, więc do weryfikacji postawionej
	hipotezy wykorzystamy testy nieparametryczne dla zmiennych powiązanych.

2. Wczytaj plik [czytelnictwo.csv](https://github.com/riomus/ZMiTAD/tree/2016/2017-zima/Listy%20zada%C5%84/Dane). Dane w nim zawarte przedstawiają ilość czasu poświęcanego na
codzienną lekturę prasy przed podjęciem pracy w firmie i po podjęciu tej pracy. Zbadaj, czy
zatrudnienie w firmie miało wpływ na ilość czasu poświęcanego na lekturę prasy. (test znaku)

3. Wybrano losowo kilka roślin chmielu i zapylono połowę każdej z nich. Otrzymane nasiona
(masa nasion w g na 10 g chmielu) zawiera plik [chmiel.csv](https://github.com/riomus/ZMiTAD/tree/2016/2017-zima/Listy%20zada%C5%84/Dane). Na poziomie istotności 0,05
zweryfikuj hipotezę, że zapylenie ma wpływ na masę nasion.

4. Sprawdź, czy średni czas poświęcany na czytanie prasy przez pracowników naszej firmy
([czytelnictwo.csv](https://github.com/riomus/ZMiTAD/tree/2016/2017-zima/Listy%20zada%C5%84/Dane)) zmienił się po przyjęciu ich do pracy. (test Wilcoxona)

5. Wczytaj plik [Dane z koronografii.csv](https://github.com/riomus/ZMiTAD/tree/2016/2017-zima/Listy%20zada%C5%84/Dane). Przy poziomie ufności 0,9 sprawdź, czy czas ćwiczenia
zależy od stanu zdrowia.

6. ** Dodatkowe:** Spróbuj zaimplementować dwustrony test znaku. [help](http://www.statisticssolutions.com/non-parametric-analysis-sign-test/) 
